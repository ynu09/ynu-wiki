<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>바운스볼 게임</title>
<style>
  body { text-align: center; font-family: sans-serif; background: #111; color: #fff; margin:0; }
  canvas { background: #222; display: block; margin: 20px auto; border: 2px solid #444; }
  #scoreDisplay { font-size: 18px; margin-top:10px; }
  #gameOverScreen {
    display:none;
    position:absolute;
    top:0; left:0; right:0; bottom:0;
    background:rgba(0,0,0,0.85);
    color:#fff;
    font-size:24px;
    text-align:center;
    padding-top:100px;
  }
  #gameOverScreen button { font-size:20px; padding:10px 20px; margin-top:20px; cursor:pointer; }
  #itemInfo { font-size:16px; margin-top:5px; color:#FF69B4; }
</style>
</head>
<body>
<h2>바운스볼 게임</h2>
<canvas id="gameCanvas" width="480" height="320"></canvas>
<p id="scoreDisplay">점수: 0 | 레벨: 1</p>
<p id="itemInfo">아이템: 패들 길이 증가</p>

<div id="gameOverScreen">
  게임 오버!<br><br>
  <button id="restartBtn">다시 시작</button>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

// 공
let ballX = canvas.width / 2;
let ballY = canvas.height - 60;
let dx = 3;
let dy = -3;
const ballRadius = 12;

// 패들
const paddleHeight = 12;
let paddleWidth = 80;
let paddleX = (canvas.width - paddleWidth) / 2;

// 점수, 레벨
let score = 0;
let level = 1;

// 아이템
let item = {x: Math.random()*(canvas.width-40), y:0, width:30, height:20, active:true, effect:"패들 길이 증가"};

// 터치/키
let rightPressed = false;
let leftPressed = false;
document.addEventListener("keydown", (e)=>{
    if(e.key === "ArrowRight") rightPressed = true;
    else if(e.key === "ArrowLeft") leftPressed = true;
});
document.addEventListener("keyup", (e)=>{
    if(e.key === "ArrowRight") rightPressed = false;
    else if(e.key === "ArrowLeft") leftPressed = false;
});
canvas.addEventListener('touchmove', (e)=>{
    const touchX = e.touches[0].clientX - canvas.getBoundingClientRect().left;
    paddleX = touchX - paddleWidth/2;
});

// 공 그리기
function drawBall(){
    ctx.beginPath();
    ctx.arc(ballX, ballY, ballRadius, 0, Math.PI*2);
    ctx.fillStyle = "#FFD700";
    ctx.fill();
    ctx.closePath();
}

// 패들 그리기
function drawPaddle(){
    ctx.beginPath();
    ctx.rect(paddleX, canvas.height - paddleHeight - 10, paddleWidth, paddleHeight);
    ctx.fillStyle = "#00FFFF";
    ctx.fill();
    ctx.closePath();
}

// 점수/레벨 표시
function drawScore(){
    document.getElementById("scoreDisplay").textContent = `점수: ${score} | 레벨: ${level}`;
}

// 아이템 그리기 (글씨 제거)
function drawItem(){
    if(!item.active) return;
    ctx.fillStyle = "#FF69B4";
    ctx.fillRect(item.x, item.y, item.width, item.height);
    item.y += 2;
}

// 게임 오버 화면
const gameOverScreen = document.getElementById("gameOverScreen");
const restartBtn = document.getElementById("restartBtn");

function gameOver(){
    gameOverScreen.style.display = "block";
}

// 게임 루프
let animationId;
function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    drawBall();
    drawPaddle();
    drawScore();
    drawItem();

    // 공 벽 충돌
    if(ballX + dx > canvas.width - ballRadius || ballX + dx < ballRadius) dx = -dx;
    if(ballY + dy < ballRadius) dy = -dy;
    else if(ballY + dy > canvas.height - ballRadius - paddleHeight - 10){
        if(ballX > paddleX && ballX < paddleX + paddleWidth){
            dy = -dy;
            ballY = canvas.height - ballRadius - paddleHeight - 10; // 충돌 위치 조정
            score += 10;
            if(score % 50 === 0){
                level++;
                dx *= 1.2;
                dy *= 1.2;
            }
        } else {
            cancelAnimationFrame(animationId);
            gameOver();
            return;
        }
    }

    // 아이템 충돌
    if(item.active &&
       item.y + item.height > canvas.height - paddleHeight - 10 &&
       item.x + item.width > paddleX && item.x < paddleX + paddleWidth){
        paddleWidth += 20;
        item.active = false;
    }
    if(item.y > canvas.height) item.active = false;

    ballX += dx;
    ballY += dy;

    if(rightPressed && paddleX < canvas.width - paddleWidth) paddleX += 6;
    if(leftPressed && paddleX > 0) paddleX -= 6;

    animationId = requestAnimationFrame(draw);
}

// 재시작 버튼
restartBtn.addEventListener("click", ()=>{
    // 변수 초기화
    ballX = canvas.width/2;
    ballY = canvas.height-60;
    dx = 3; dy = -3;
    paddleWidth = 80;
    paddleX = (canvas.width - paddleWidth)/2;
    score = 0;
    level = 1;
    item = {x: Math.random()*(canvas.width-40), y:0, width:30, height:20, active:true, effect:"패들 길이 증가"};
    gameOverScreen.style.display = "none";
    draw();
});

draw();
</script>
</body>
</html>
